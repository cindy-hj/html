<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>게시판 목록</title>
    <style>
        .container {

            width: 900px;
            border: 1px solid #cccccc;
            padding: 30px;
            margin: 0px auto;
        }
        table {
            width: 100%;
            background-color: azure;

            border-collapse: collapse;
        }
    </style>
</head>

<body>
    <div class="container">
        <h3>게시판 목록</h3>
        <a href="/boardwrite2.html"><button>게시판 글쓰기</button></a>
        <hr />

        <table border = "1">

            <thead>
                <tr>
                    <th>번호</th>
                    <th>제목</th>
                    <th>작성자</th>
                    <th>조회수</th>
                    <th>날짜</th>
                </tr>
            </thead>

            
            <tbody id="tbody"></tbody>
        </table>

    </div>


    <script src="js/axios.min.js" type="text/javascript"></script>
    <script>
        const tbody = document.getElementById('tbody');


        async function handleHit(f) {
            const url = `http://1.234.5.158:23000/board101/updatehit.json?no=${f}`;
            const headers = {"Content-Type":"application/json"};
            const body = {}; 
            const {data} = await axios.put(url, body, {headers});
           
            window.location.href=`/boardone2.html?no=${f}`;
        }


        async function onMounted() {
            const url =`http://1.234.5.158:23000/board101/select.json?page=1&text=`;
            const headers = {"Content-Type":"application/json"};
            const { data } = await axios.get(url, {headers});
            // console.log(data);

            if(data.status === 200) {
                for(let tmp of data.rows) {
                    // console.log(tmp);
                    tbody.innerHTML +=
                    `<tr>` +
                        `<td>${tmp._id}</td>`+
                        `<td><a href='#' onclick='handleHit(${tmp._id})'>${tmp.title}</a></td>`+
                        `<td>${tmp.writer}</td>`+
                        `<td>${tmp.hit}</td>`+
                        `<td>${tmp.regdate}</td>`+
                    `</tr>`
                }
            }
            else {
                alert('서버 오류');
            }
        }

        onMounted();



    </script>
</body>

</html>